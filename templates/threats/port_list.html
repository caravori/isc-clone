{% extends 'base.html' %}

{% block title %}Port Activity - {{ site_settings.site_name }}{% endblock %}

{% block content %}
<div class="card">
    <h2>Port Activity Monitoring</h2>
    <p>Real-time port scanning statistics and risk assessment.</p>
    
    <div style="margin-top: 1rem;">
        <strong>Filter by Risk:</strong>
        <a href="?risk=low" class="btn" style="background: #10b981; margin: 0.25rem;">Low</a>
        <a href="?risk=medium" class="btn" style="background: #f59e0b; margin: 0.25rem;">Medium</a>
        <a href="?risk=high" class="btn" style="background: #f97316; margin: 0.25rem;">High</a>
        <a href="?risk=critical" class="btn" style="background: #ef4444; margin: 0.25rem;">Critical</a>
        <a href="{% url 'threats:ports' %}" class="btn" style="background: #6b7280; margin: 0.25rem;">All</a>
    </div>
</div>

<div class="card">
    <table style="width: 100%;">
        <thead>
            <tr style="border-bottom: 2px solid #e5e7eb;">
                <th style="padding: 0.75rem; text-align: left;">Port/Protocol</th>
                <th style="padding: 0.75rem; text-align: left;">Service</th>
                <th style="padding: 0.75rem; text-align: center;">Scan Count</th>
                <th style="padding: 0.75rem; text-align: center;">Risk Level</th>
                <th style="padding: 0.75rem; text-align: left;">Last Seen</th>
            </tr>
        </thead>
        <tbody>
            {% for port in ports %}
            <tr style="border-bottom: 1px solid #f3f4f6;">
                <td style="padding: 0.75rem;"><strong>{{ port.port_number }}/{{ port.protocol }}</strong></td>
                <td style="padding: 0.75rem;">{{ port.service_name|default:"Unknown" }}</td>
                <td style="padding: 0.75rem; text-align: center;"><strong>{{ port.scan_count }}</strong></td>
                <td style="padding: 0.75rem; text-align: center;">
                    <span style="padding: 0.25rem 0.75rem; border-radius: 4px; font-weight: 500; background: {% if port.risk_level == 'critical' %}#fee2e2; color: #991b1b{% elif port.risk_level == 'high' %}#fed7aa; color: #9a3412{% elif port.risk_level == 'medium' %}#fef3c7; color: #92400e{% else %}#d1fae5; color: #065f46{% endif %};">
                        {{ port.risk_level|upper }}
                    </span>
                </td>
                <td style="padding: 0.75rem;">{{ port.last_seen|date:"M d, Y H:i" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="padding: 2rem; text-align: center; color: #6b7280;">No port activity recorded.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
