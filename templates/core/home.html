{% extends 'base.html' %}

{% block title %}Home - {{ block.super }}{% endblock %}

{% block content %}
<div class="card" style="background: #f0fdf4; border-left: 4px solid #4ade80;">
    <h2 style="color: #2d5016; margin-bottom: 0.5rem;">Welcome to {{ site_settings.site_name }}</h2>
    <p style="color: #3f6212;">Cybersecurity threat intelligence and handler insights. Stay informed about the latest security threats and analysis.</p>
</div>

{% if current_threat %}
<div class="card" style="border-left: 4px solid {% if current_threat.level == 'low' %}#4ade80{% elif current_threat.level == 'medium' %}#fbbf24{% elif current_threat.level == 'high' %}#fb923c{% else %}#f87171{% endif %};">
    <h2>Current Threat Level: <span style="color: {% if current_threat.level == 'low' %}#16a34a{% elif current_threat.level == 'medium' %}#d97706{% elif current_threat.level == 'high' %}#ea580c{% else %}#dc2626{% endif %}; text-transform: uppercase;">{{ current_threat.get_level_display }}</span></h2>
    <p style="margin-top: 1rem;">{{ current_threat.description }}</p>
    <p class="text-muted" style="margin-top: 0.75rem;">Last updated: {{ current_threat.recorded_date|date:"F j, Y, g:i a" }}</p>
    <a href="{% url 'threats:dashboard' %}" class="btn" style="margin-top: 1rem;">View Dashboard</a>
</div>
{% endif %}

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="margin: 0;">Latest Handler Diaries</h2>
        <a href="{% url 'blog:post_list' %}" class="btn-secondary btn">View All</a>
    </div>
    
    {% if latest_posts %}
        {% for post in latest_posts %}
        <div class="post-item">
            <h3><a href="{% url 'blog:post_detail' post.slug %}">{{ post.title }}</a></h3>
            <p class="text-muted" style="margin: 0.5rem 0;">
                By {{ post.author.get_full_name|default:post.author.username }} | {{ post.published_date|date:"F j, Y" }}
                {% if post.category %} | {{ post.category.name }}{% endif %}
            </p>
            <p style="color: #4b5563;">{{ post.excerpt|default:post.content|striptags|truncatewords:40 }}</p>
        </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">No posts yet. <a href="/admin/blog/post/add/">Create your first post</a>.</p>
    {% endif %}
</div>
{% endblock %}
